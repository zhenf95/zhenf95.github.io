<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Grouped Fixed Effects | MISSS Blog</title><meta name=keywords content="discrete heterogeneity,panel data,fixed effects,democracy"><meta name=description content="Grouped Patterns of Heterogeneity in Panel Data (with Elena Manresa)
Econometrica, 83(3), 1147-1184, May 2015.
Summary: This post basically summarizes the grouped panel data model, which allows time-varying grouped patterns of unobservable heterogeneity in linear panel data models (Bonhomme and Manresa 2015).
Model Specification The linear model with grouped patterns of heterogeneity:
$$ y_{it} = x'_{it}\theta + \alpha_{g_{i}t}+v_{it},\quad\quad i = 1,&mldr;,N,\quad t = 1,&mldr;,T, $$ where
​	$x_{ij}$: covariates, $E[v_{ij}|x_{ij}]=0$"><meta name=author content="Me"><link rel=canonical href=https://zhenf95.github.io/posts/2021-03-03-grouped-fixed-effects/><meta name=google-site-verification content="XYZabc"><link href=/assets/css/stylesheet.min.1eef9c740af75b4e5f773d9d5f757e03e3df71f3a308e73070cc73d55a59a7d7.css integrity="sha256-Hu+cdAr3W05fdz2dX3V+A+PfcfOjCOcwcMxz1VpZp9c=" rel="preload stylesheet" as=style><link rel=icon href=https://zhenf95.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://zhenf95.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://zhenf95.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://zhenf95.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://zhenf95.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.81.0"><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-123-45','auto'),ga('send','pageview'))</script><script async src=https://www.google-analytics.com/analytics.js></script><meta property="og:title" content="Grouped Fixed Effects"><meta property="og:description" content="Grouped Patterns of Heterogeneity in Panel Data (with Elena Manresa)
Econometrica, 83(3), 1147-1184, May 2015.
Summary: This post basically summarizes the grouped panel data model, which allows time-varying grouped patterns of unobservable heterogeneity in linear panel data models (Bonhomme and Manresa 2015).
Model Specification The linear model with grouped patterns of heterogeneity:
$$ y_{it} = x'_{it}\theta + \alpha_{g_{i}t}+v_{it},\quad\quad i = 1,&mldr;,N,\quad t = 1,&mldr;,T, $$ where
​	$x_{ij}$: covariates, $E[v_{ij}|x_{ij}]=0$"><meta property="og:type" content="article"><meta property="og:url" content="https://zhenf95.github.io/posts/2021-03-03-grouped-fixed-effects/"><meta property="og:image" content="https://zhenf95.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:published_time" content="2021-03-03T22:05:11-08:00"><meta property="article:modified_time" content="2021-03-03T22:05:11-08:00"><meta property="og:site_name" content="MISSS Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://zhenf95.github.io/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Grouped Fixed Effects"><meta name=twitter:description content="Grouped Patterns of Heterogeneity in Panel Data (with Elena Manresa)
Econometrica, 83(3), 1147-1184, May 2015.
Summary: This post basically summarizes the grouped panel data model, which allows time-varying grouped patterns of unobservable heterogeneity in linear panel data models (Bonhomme and Manresa 2015).
Model Specification The linear model with grouped patterns of heterogeneity:
$$ y_{it} = x'_{it}\theta + \alpha_{g_{i}t}+v_{it},\quad\quad i = 1,&mldr;,N,\quad t = 1,&mldr;,T, $$ where
​	$x_{ij}$: covariates, $E[v_{ij}|x_{ij}]=0$"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://zhenf95.github.io/posts/"},{"@type":"ListItem","position":3,"name":"Grouped Fixed Effects","item":"https://zhenf95.github.io/posts/2021-03-03-grouped-fixed-effects/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Grouped Fixed Effects","name":"Grouped Fixed Effects","description":"Grouped Patterns of Heterogeneity in Panel Data (with Elena Manresa)\nEconometrica, 83(3), 1147-1184, May 2015.\nSummary: This post basically summarizes the grouped panel data model, …","keywords":["discrete heterogeneity","panel data","fixed effects","democracy"],"articleBody":"Grouped Patterns of Heterogeneity in Panel Data (with Elena Manresa)\nEconometrica, 83(3), 1147-1184, May 2015.\nSummary: This post basically summarizes the grouped panel data model, which allows time-varying grouped patterns of unobservable heterogeneity in linear panel data models (Bonhomme and Manresa 2015).\nModel Specification The linear model with grouped patterns of heterogeneity:\n$$ y_{it} = x'_{it}\\theta + \\alpha_{g_{i}t}+v_{it},\\quad\\quad i = 1,…,N,\\quad t = 1,…,T, $$ where\n​\t$x_{ij}$: covariates, $E[v_{ij}|x_{ij}]=0$\n​\t$\\alpha_{g_{i}t}$: unrestricted group-specific unobservables, Grouped Fixed Effects (GFE)\n​\t$g_{i}\\in{1,…,G}$: group membership variables, time-invariant\n​\t$G$: the number of groups, to be set or estimated by the researcher\nEstimation GFE estimator in model (1) can be defined as the solution of the following problem: $$ (\\hat{\\theta},\\hat{\\alpha},\\hat{\\gamma})=\\underset{(\\theta,\\alpha,\\gamma)\\in \\mathit{\\Theta} \\times \\mathcal{A}^{GT}\\times\\mathit{\\Gamma}_G}{\\operatorname{argmin}}\\sum_{i=1}^{N}\\sum_{t=1}^{T}(y_{it}-x'_{it}\\theta-\\alpha_{g_{i}t})^2 $$ where\n​\tCovariates parameters: $\\theta\\in\\mathit{\\Theta}$, $\\mathit{\\Theta}\\subseteq\\mathbb{R}^K$\n​\tGroup-specific time effects: $\\alpha_{gt}\\in\\mathcal{A}$, $\\mathcal{A}\\subseteq\\mathbb{R}$\n​\tGroup membership variables: $g_i$\n​\t$\\alpha$: the set of all $\\alpha_{g_{i}t}$\n​\t$\\gamma={g_1,…,g_N}$, $\\gamma\\in\\mathit{\\Gamma}_G$\n​\t$\\mathit{\\Gamma}_G$: the set of all groupings of ${1,…,N}$ into at most $G$ groups\nWe can estimate the above GFE estimator by the following algorithm:\nAlgorithm 1: Iterative:\n  Let $(\\theta^{(0)},\\alpha^{(0)})\\in\\mathit{\\Theta}\\times\\mathcal{A}^{GT}$ be some starting value. Set $s=0$.\n  (Assignment step) Compute for all $i\\in{1,…,N}$: $$ g_i^{s+1}=\\underset{g\\in{1,…,G}}{\\operatorname{argmin}}\\sum_{t=1}^T(y_{it}-x'_{it}\\theta^{(s)}-\\alpha_{gt}^{(s)})^2 $$\n  (Update step) Compute: $$ (\\theta^{(s+1)},\\alpha^{(s+1)})=\\underset{(\\theta,\\alpha)\\in \\mathit{\\Theta} \\times \\mathcal{A}^{GT}}{\\operatorname{argmin}}\\sum_{i=1}^N\\sum_{t=1}^N(y_{it}-x'_{it}\\theta-\\alpha_{g_i^{(s+1)}t}) $$\n  Set $s=s+1$ and go to Step 2 (until numerical convergence).\n  To solve large scale problem, we can use kmeans clustering algorithm (Forgy 1965) to develop a more efficient computational routine, as proposed in Algorithm 2.\nAlgorithm 2: Variable Neighborhood Search\n  Let $(\\theta,\\alpha)\\in\\mathit{\\Theta}\\times\\mathcal{A}^{GT}$ be some starting value.\nPerform one assignment step of Algorithm 1 and obtain an initial grouping $\\gamma_{\\text{init}}$.\nSet $iter_{\\text{max}}$ and $neigh_{\\text{max}}$ to some desired values.\nSet $j=0$.\nSet $\\gamma^*=\\gamma_{\\text{init}}$.\n  Set $n=1$.\n  (Neighborhood jump) Relocate $n$ randomly selected units to $n$ randomly selected groups, and obtain a new grouping $\\gamma^{\\prime}$.\nPerform one updated step of Algorithm 1 and obtain new parameter values $(\\theta^{\\prime},\\alpha^{\\prime})$.\n  Set $(\\theta^{(0)},\\alpha^{(0)})=(\\theta^{\\prime},\\alpha^{\\prime})$, and apply Algorithm 1.\n  (Local search) Starting from the grouping $\\gamma={g_1,…,g_N}$ obtained in Step 4, systematically check all reassignments of units $i\\in{1,…,N}$ to groups $g\\in{1,…,G}$ (for $g\\ne g_i$), updating $g_i$ when the objective function decreases; stop when no further reassignment improves the objective function.\nLet the resulting grouping be $\\gamma^{\\prime\\prime}$.\n  If the objective function using $\\gamma^{\\prime\\prime}$ improves relative to the one using $\\gamma^*$, then set $\\gamma^*=\\gamma^{\\prime\\prime}$ and go to Step 2; otherwise, set $n=n+1$ and go to Step 7.\n  If $n\\leq neigh_{\\text{max}}$, then go to Step 3; otherwise go to Step 8.\n  Set $j=j+1$. If $jiter_{\\text{max}}$, then Stop; otherwise go to Step 2.\n  Extensions   Unit-Specific Heterogeneity $$ y_{it}=x'_{it}\\theta+\\alpha_{g_{i}t}+\\eta_i+v_{it} $$ This can be transformed into (1) by taking deviations: $$ y_{it}-\\bar{y}_i=(x'_{it}-\\bar{x}_i)\\theta+\\alpha_{g_{i}t}-\\bar{\\alpha}_{g_i}+v_{it}-\\bar{v}_i $$\n  Heterogeneous Coefficients $$ y_{it}=x'_{it}\\theta_{g_{i}}+\\alpha_{g_{i}t}+v_{it} $$ This can be estimated by the following estimator: $$ (\\hat{\\theta},\\hat{\\alpha},\\hat{\\gamma})=\\underset{(\\theta,\\alpha,\\gamma)\\in \\mathit{\\Theta} \\times \\mathcal{A}^{GT}\\times\\mathit{\\Gamma}_G}{\\operatorname{argmin}}\\sum_{i=1}^{N}\\sum_{t=1}^{T}(y_{it}-x'_{it}\\theta_{g_i}-\\alpha_{g_{i}t})^2 $$\n  Nonlinear Models\n  Suppose $m_{it}(\\cdot)$ is a function dependent on data, we can formulate the estimator of any nonlinear models as follows: $$ (\\hat{\\theta},\\hat{\\alpha},\\hat{\\gamma})=\\underset{(\\theta,\\alpha,\\gamma)\\in \\mathit{\\Theta} \\times \\mathcal{A}^{GT}\\times\\mathit{\\Gamma}_G}{\\operatorname{argmin}}\\sum_{i=1}^{N}\\sum_{t=1}^{T}m_{it}(\\theta,\\alpha_t,g_i) $$\nThis can be transformed into likelihood models as special cases by taking $m_{it}(\\theta,\\alpha_t,g_i)=-\\ln f(y_{it}|x_{it};\\theta,\\alpha_t,g_i)$, where $f(\\cdot)$ is the parametric density function. Thus, we can also estimate the static and dynamic discrete choice models.\nComparison Unit-specific Fixed Effects: fixed effects estimators suffer from an $O(1/T)$ bias as $N/T$ tends to a constant (Arellano and Hahn 2007). GFE estimator is consistent and asymptotically normal as $N/T^\\nu$ tends to zero for some $\\nu0$. This makes GFE estimator more suitable to the context where $N$ grow substantially faster than $T$.\nFinite Mixture Models: restrict the relationship between unobserved heterogeneity and covariates (McLachlan and Peel 2000, Frühwirth-Schnatter 2006), GFE estimates the unrestricted relationship.\nInteractive Fixed Effects: (Bai 2009) GFE has a similar factor-analytic structure as this model $\\alpha_{g_{i}t}=\\sum_{g=1}^{G}\\mathbf{1}\\{g_{i}=g\\}\\alpha_{gt}$. With data of short panels and grouped structure, GFE is more parsimonious.\nOther models with group structure:\n Bester and Hansen (2013): grouping individual fixed-effects with known groups can gain precision Lin and Ng (2012): random coefficients model with time-series regression to classify individuals into groups  Other Models  Spatial dependence models for panel data (Sarafidis and Wansbeek 2012) Social interaction models for panel data (Blume, Brock, Durlauf, and Ioannides 2011) Interactive fixed-effects models (Bai 2009)  Useful Resources  Supplementary appendix Replication files Stata code to compute the grouped fixed-effects estimator on your data  References Arellano, M., \u0026 Hahn, J. (2007). Understanding bias in nonlinear panel models: Some recent developments. Econometric Society Monographs, 43, 381.\nBai, J. (2009). Panel data models with interactive fixed effects. Econometrica, 77(4), 1229-1279.\nBester, C. A., \u0026 Hansen, C. B. (2016). Grouped effects estimators in fixed effects models. Journal of Econometrics, 190(1), 197-208.\nBonhomme, S., \u0026 Manresa, E. (2015). Grouped patterns of heterogeneity in panel data. Econometrica, 83(3), 1147-1184.\nBlume, L. E., Brock, W. A., Durlauf, S. N., \u0026 Ioannides, Y. M. (2011). Identification of social interactions. In Handbook of social economics (Vol. 1, pp. 853-964). North-Holland.\nForgy, E. W. (1965). Cluster Analysis of Multivariate Data: Efficiency vs. Interpretability of Classifications, Biometrics, 21, 768–769.\nFrühwirth-Schnatter, S. (2006). Finite mixture and Markov switching models. Springer Science \u0026 Business Media.\nLin, C. C., \u0026 Ng, S. (2012). Estimation of panel data models with parameter heterogeneity when group membership is unknown. Journal of Econometric Methods, 1(1), 42-55.\nMcLachlan, G., \u0026 Peel, D. (2000). Finite Mixture Models. Wiley Series in Probability and Statistics: Applied Probability and Statistics. New York: Wiley-Interscience.\nSarafidis, V., \u0026 Wansbeek, T. (2012). Cross-sectional dependence in panel data analysis. Econometric Reviews, 31(5), 483-531.\n","wordCount":"882","inLanguage":"en","datePublished":"2021-03-03T22:05:11-08:00","dateModified":"2021-03-03T22:05:11-08:00","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zhenf95.github.io/posts/2021-03-03-grouped-fixed-effects/"},"publisher":{"@type":"Organization","name":"MISSS Blog","logo":{"@type":"ImageObject","url":"https://zhenf95.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://zhenf95.github.io accesskey=h title="Home (Alt + H)"><img src=/apple-touch-icon.png alt=logo aria-label=logo height=35>Home</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://zhenf95.github.io/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://zhenf95.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://zhenf95.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://zhenf95.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav><script type=text/x-mathjax-config>
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$']],
      processEscapes: true
    }
  });
</script><script type=text/javascript src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://zhenf95.github.io>Home</a>&nbsp;»&nbsp;<a href=https://zhenf95.github.io/posts/>Posts</a></div><h1 class=post-title>Grouped Fixed Effects</h1><div class=post-meta>March 3, 2021&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Me</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><div class=details>Table of Contents</div></summary><div class=inner><ul><li><a href=#model-specification aria-label="Model Specification">Model Specification</a></li><li><a href=#estimation aria-label=Estimation>Estimation</a></li><li><a href=#extensions aria-label=Extensions>Extensions</a></li><li><a href=#comparison aria-label=Comparison>Comparison</a></li><li><a href=#other-models aria-label="Other Models">Other Models</a></li><li><a href=#useful-resources aria-label="Useful Resources">Useful Resources</a></li><li><a href=#references aria-label=References>References</a></li></ul></div></details></div><div class=post-content><p><a href=https://onlinelibrary.wiley.com/doi/pdf/10.3982/ECTA11319>Grouped Patterns of Heterogeneity in Panel Data</a> (with <a href="https://www.google.com/url?q=https%3A%2F%2Fmanresaelena.wixsite.com%2Fhome&sa=D&sntz=1&usg=AFQjCNELNK4HfCrCWE4ZSkGXD5AkDY0o6g">Elena Manresa</a>)</p><p><em>Econometrica,</em> 83(3), 1147-1184, May 2015.</p><p>Summary: This post basically summarizes the grouped panel data model, which allows time-varying grouped patterns of unobservable heterogeneity in linear panel data models (Bonhomme and Manresa 2015).</p><h3 id=model-specification>Model Specification<a hidden class=anchor aria-hidden=true href=#model-specification>#</a></h3><p>The linear model with grouped patterns of heterogeneity:</p><p>$$
y_{it} = x'_{it}\theta + \alpha_{g_{i}t}+v_{it},\quad\quad i = 1,&mldr;,N,\quad t = 1,&mldr;,T,
$$
where</p><p>​ $x_{ij}$: covariates, $E[v_{ij}|x_{ij}]=0$</p><p>​ $\alpha_{g_{i}t}$: unrestricted group-specific unobservables, Grouped Fixed Effects (GFE)</p><p>​ $g_{i}\in{1,&mldr;,G}$: group membership variables, time-invariant</p><p>​ $G$: the number of groups, to be set or estimated by the researcher</p><h3 id=estimation>Estimation<a hidden class=anchor aria-hidden=true href=#estimation>#</a></h3><p>GFE estimator in model (1) can be defined as the solution of the following problem:
$$
(\hat{\theta},\hat{\alpha},\hat{\gamma})=\underset{(\theta,\alpha,\gamma)\in \mathit{\Theta} \times \mathcal{A}^{GT}\times\mathit{\Gamma}_G}{\operatorname{argmin}}\sum_{i=1}^{N}\sum_{t=1}^{T}(y_{it}-x'_{it}\theta-\alpha_{g_{i}t})^2
$$
where</p><p>​ Covariates parameters: $\theta\in\mathit{\Theta}$, $\mathit{\Theta}\subseteq\mathbb{R}^K$</p><p>​ Group-specific time effects: $\alpha_{gt}\in\mathcal{A}$, $\mathcal{A}\subseteq\mathbb{R}$</p><p>​ Group membership variables: $g_i$</p><p>​ $\alpha$: the set of all $\alpha_{g_{i}t}$</p><p>​ $\gamma={g_1,&mldr;,g_N}$, $\gamma\in\mathit{\Gamma}_G$</p><p>​ $\mathit{\Gamma}_G$: the set of all groupings of ${1,&mldr;,N}$ into at most $G$ groups</p><p>We can estimate the above GFE estimator by the following algorithm:</p><p><em>Algorithm 1</em>: Iterative:</p><ol><li><p>Let $(\theta^{(0)},\alpha^{(0)})\in\mathit{\Theta}\times\mathcal{A}^{GT}$ be some starting value. Set $s=0$.</p></li><li><p>(Assignment step) Compute for all $i\in{1,&mldr;,N}$:
$$
g_i^{s+1}=\underset{g\in{1,&mldr;,G}}{\operatorname{argmin}}\sum_{t=1}^T(y_{it}-x'_{it}\theta^{(s)}-\alpha_{gt}^{(s)})^2
$$</p></li><li><p>(Update step) Compute:
$$
(\theta^{(s+1)},\alpha^{(s+1)})=\underset{(\theta,\alpha)\in \mathit{\Theta} \times \mathcal{A}^{GT}}{\operatorname{argmin}}\sum_{i=1}^N\sum_{t=1}^N(y_{it}-x'_{it}\theta-\alpha_{g_i^{(s+1)}t})
$$</p></li><li><p>Set $s=s+1$ and go to Step 2 (until numerical convergence).</p></li></ol><p>To solve large scale problem, we can use <em>kmeans</em> clustering algorithm (Forgy 1965) to develop a more efficient computational routine, as proposed in Algorithm 2.</p><p><em>Algorithm 2</em>: Variable Neighborhood Search</p><ol><li><p>Let $(\theta,\alpha)\in\mathit{\Theta}\times\mathcal{A}^{GT}$ be some starting value.</p><p>Perform one assignment step of Algorithm 1 and obtain an initial grouping $\gamma_{\text{init}}$.</p><p>Set $iter_{\text{max}}$ and $neigh_{\text{max}}$ to some desired values.</p><p>Set $j=0$.</p><p>Set $\gamma^*=\gamma_{\text{init}}$.</p></li><li><p>Set $n=1$.</p></li><li><p>(Neighborhood jump) Relocate $n$ randomly selected units to $n$ randomly selected groups, and obtain a new grouping $\gamma^{\prime}$.</p><p>Perform one updated step of Algorithm 1 and obtain new parameter values $(\theta^{\prime},\alpha^{\prime})$.</p></li><li><p>Set $(\theta^{(0)},\alpha^{(0)})=(\theta^{\prime},\alpha^{\prime})$, and apply Algorithm 1.</p></li><li><p>(Local search) Starting from the grouping $\gamma={g_1,&mldr;,g_N}$ obtained in Step 4, systematically check all reassignments of units $i\in{1,&mldr;,N}$ to groups $g\in{1,&mldr;,G}$ (for $g\ne g_i$), updating $g_i$ when the objective function decreases; stop when no further reassignment improves the objective function.</p><p>Let the resulting grouping be $\gamma^{\prime\prime}$.</p></li><li><p>If the objective function using $\gamma^{\prime\prime}$ improves relative to the one using $\gamma^*$, then set $\gamma^*=\gamma^{\prime\prime}$ and go to Step 2; otherwise, set $n=n+1$ and go to Step 7.</p></li><li><p>If $n\leq neigh_{\text{max}}$, then go to Step 3; otherwise go to Step 8.</p></li><li><p>Set $j=j+1$. If $j>iter_{\text{max}}$, then Stop; otherwise go to Step 2.</p></li></ol><h3 id=extensions>Extensions<a hidden class=anchor aria-hidden=true href=#extensions>#</a></h3><ol><li><p>Unit-Specific Heterogeneity
$$
y_{it}=x'_{it}\theta+\alpha_{g_{i}t}+\eta_i+v_{it}
$$
This can be transformed into (1) by taking deviations:
$$
y_{it}-\bar{y}_i=(x'_{it}-\bar{x}_i)\theta+\alpha_{g_{i}t}-\bar{\alpha}_{g_i}+v_{it}-\bar{v}_i
$$</p></li><li><p>Heterogeneous Coefficients
$$
y_{it}=x'_{it}\theta_{g_{i}}+\alpha_{g_{i}t}+v_{it}
$$
This can be estimated by the following estimator:
$$
(\hat{\theta},\hat{\alpha},\hat{\gamma})=\underset{(\theta,\alpha,\gamma)\in \mathit{\Theta} \times \mathcal{A}^{GT}\times\mathit{\Gamma}_G}{\operatorname{argmin}}\sum_{i=1}^{N}\sum_{t=1}^{T}(y_{it}-x'_{it}\theta_{g_i}-\alpha_{g_{i}t})^2
$$</p></li><li><p>Nonlinear Models</p></li></ol><p>Suppose $m_{it}(\cdot)$ is a function dependent on data, we can formulate the estimator of any nonlinear models as follows:
$$
(\hat{\theta},\hat{\alpha},\hat{\gamma})=\underset{(\theta,\alpha,\gamma)\in \mathit{\Theta} \times \mathcal{A}^{GT}\times\mathit{\Gamma}_G}{\operatorname{argmin}}\sum_{i=1}^{N}\sum_{t=1}^{T}m_{it}(\theta,\alpha_t,g_i)
$$</p><p>This can be transformed into likelihood models as special cases by taking $m_{it}(\theta,\alpha_t,g_i)=-\ln f(y_{it}|x_{it};\theta,\alpha_t,g_i)$, where $f(\cdot)$ is the parametric density function. Thus, we can also estimate the static and dynamic discrete choice models.</p><h3 id=comparison>Comparison<a hidden class=anchor aria-hidden=true href=#comparison>#</a></h3><p><em>Unit-specific Fixed Effects</em>: fixed effects estimators suffer from an $O(1/T)$ bias as $N/T$ tends to a constant (Arellano and Hahn 2007). GFE estimator is consistent and asymptotically normal as $N/T^\nu$ tends to zero for some $\nu>0$. This makes GFE estimator more suitable to the context where $N$ grow substantially faster than $T$.</p><p><em>Finite Mixture Models</em>: restrict the relationship between unobserved heterogeneity and covariates (McLachlan and Peel 2000, Frühwirth-Schnatter 2006), GFE estimates the unrestricted relationship.</p><p><em>Interactive Fixed Effects</em>: (Bai 2009) GFE has a similar factor-analytic structure as this model $\alpha_{g_{i}t}=\sum_{g=1}^{G}\mathbf{1}\{g_{i}=g\}\alpha_{gt}$. With data of short panels and grouped structure, GFE is more parsimonious.</p><p>Other models with group structure:</p><ul><li>Bester and Hansen (2013): grouping individual fixed-effects with known groups can gain precision</li><li>Lin and Ng (2012): random coefficients model with time-series regression to classify individuals into groups</li></ul><h3 id=other-models>Other Models<a hidden class=anchor aria-hidden=true href=#other-models>#</a></h3><ul><li>Spatial dependence models for panel data (Sarafidis and Wansbeek 2012)</li><li>Social interaction models for panel data (Blume, Brock, Durlauf, and Ioannides 2011)</li><li>Interactive fixed-effects models (Bai 2009)</li></ul><h3 id=useful-resources>Useful Resources<a hidden class=anchor aria-hidden=true href=#useful-resources>#</a></h3><ul><li><a href=https://www.econometricsociety.org/sites/default/files/ECTA11319SUPP.pdf>Supplementary appendix</a></li><li><a href="https://www.google.com/url?q=https%3A%2F%2Fwww.dropbox.com%2Fs%2Fssjabvc2hxa5791%2FBonhomme_Manresa_codes.zip%3Fdl%3D0&sa=D&sntz=1&usg=AFQjCNHp5Nc9B_912jFVVr7jMKY8fNMBrQ">Replication files</a></li><li><a href="https://www.google.com/url?q=https%3A%2F%2Fwww.dropbox.com%2Fs%2F662tvxmw5kpzgjp%2FGFE_codes.zip%3Fdl%3D0&sa=D&sntz=1&usg=AFQjCNHbB5GyptCkEiposFqmBWNO21QhpQ">Stata code to compute the grouped fixed-effects estimator on your data</a></li></ul><h3 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h3><p>Arellano, M., & Hahn, J. (2007). Understanding bias in nonlinear panel models: Some recent developments. <em>Econometric Society Monographs</em>, <em>43</em>, 381.</p><p>Bai, J. (2009). Panel data models with interactive fixed effects. <em>Econometrica</em>, <em>77</em>(4), 1229-1279.</p><p>Bester, C. A., & Hansen, C. B. (2016). Grouped effects estimators in fixed effects models. <em>Journal of Econometrics</em>, <em>190</em>(1), 197-208.</p><p>Bonhomme, S., & Manresa, E. (2015). Grouped patterns of heterogeneity in panel data. <em>Econometrica</em>, <em>83</em>(3), 1147-1184.</p><p>Blume, L. E., Brock, W. A., Durlauf, S. N., & Ioannides, Y. M. (2011). Identification of social interactions. In <em>Handbook of social economics</em> (Vol. 1, pp. 853-964). North-Holland.</p><p>Forgy, E. W. (1965). Cluster Analysis of Multivariate Data: Efficiency vs. Interpretability of Classifications, <em>Biometrics</em>, 21, 768&ndash;769.</p><p>Frühwirth-Schnatter, S. (2006). <em>Finite mixture and Markov switching models</em>. Springer Science & Business Media.</p><p>Lin, C. C., & Ng, S. (2012). Estimation of panel data models with parameter heterogeneity when group membership is unknown. <em>Journal of Econometric Methods</em>, <em>1</em>(1), 42-55.</p><p>McLachlan, G., & Peel, D. (2000). <em>Finite Mixture Models</em>. Wiley Series in Probability and Statistics: Applied Probability and Statistics. New York: Wiley-Interscience.</p><p>Sarafidis, V., & Wansbeek, T. (2012). Cross-sectional dependence in panel data analysis. <em>Econometric Reviews</em>, <em>31</em>(5), 483-531.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://zhenf95.github.io/tags/discrete-heterogeneity/>discrete heterogeneity</a></li><li><a href=https://zhenf95.github.io/tags/panel-data/>panel data</a></li><li><a href=https://zhenf95.github.io/tags/fixed-effects/>fixed effects</a></li><li><a href=https://zhenf95.github.io/tags/democracy/>democracy</a></li></ul><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Grouped Fixed Effects on twitter" href="https://twitter.com/intent/tweet/?text=Grouped%20Fixed%20Effects&url=https%3a%2f%2fzhenf95.github.io%2fposts%2f2021-03-03-grouped-fixed-effects%2f&hashtags=discreteheterogeneity%2cpaneldata%2cfixedeffects%2cdemocracy"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Grouped Fixed Effects on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fzhenf95.github.io%2fposts%2f2021-03-03-grouped-fixed-effects%2f&title=Grouped%20Fixed%20Effects&summary=Grouped%20Fixed%20Effects&source=https%3a%2f%2fzhenf95.github.io%2fposts%2f2021-03-03-grouped-fixed-effects%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Grouped Fixed Effects on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fzhenf95.github.io%2fposts%2f2021-03-03-grouped-fixed-effects%2f&title=Grouped%20Fixed%20Effects"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Grouped Fixed Effects on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fzhenf95.github.io%2fposts%2f2021-03-03-grouped-fixed-effects%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Grouped Fixed Effects on whatsapp" href="https://api.whatsapp.com/send?text=Grouped%20Fixed%20Effects%20-%20https%3a%2f%2fzhenf95.github.io%2fposts%2f2021-03-03-grouped-fixed-effects%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Grouped Fixed Effects on telegram" href="https://telegram.me/share/url?text=Grouped%20Fixed%20Effects&url=https%3a%2f%2fzhenf95.github.io%2fposts%2f2021-03-03-grouped-fixed-effects%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://zhenf95.github.io>MISSS Blog</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script defer src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script><script>window.onload=function(){localStorage.getItem("menu-scroll-position")&&(document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position"))},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})});var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft)}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>